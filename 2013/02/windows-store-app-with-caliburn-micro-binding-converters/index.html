<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="last-modified" content="2013-08-03T16:21:53.1781387+08:00" />
    <title>philliphaydon.com</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/style.css" />
</head>
<body class="home blog">
    <div id="page" class="hfeed site">
        <header id="masthead" class="site-header fancy-container lightgreen" role="banner">
            <hgroup>
                <h1 class="site-title"><a href="/" title="philliphaydon.com" rel="home">philliphaydon.com</a></h1>
                <h2><small>Works on my PC...</small></h2>
                <p class="site-description">Pleb from New Zealand who was banished overseas and currently resides in Singapore.</p>
            </hgroup>
            <nav role="navigation" class="site-navigation main-navigation">
                <h1 class="assistive-text">Menu</h1>
                <div class="assistive-text skip-link"><a href="#content" title="Skip to content">Skip to content</a></div>
                <div class="menu">
                    <ul>
                        <li><a href="/about">About</a></li>
                        <li><a href="/category">Categories</a></li>
                        <li><a href="/archive">Archive</a></li>
                        <li><a href="/rss">RSS</a> / <a href="/feed">Atom</a></li>
                    </ul>
                </div>
            </nav>
        </header>
        <div id="main">
            <div id="primary" class="site-content">
                <div id="content" role="main">
                  

<div id="post">
    <h1>Windows Store App with Caliburn.Micro - Binding Converters</h1>

    <div class="post-note">
      posted on 26 Feb 2013
       | <a href="/category/windows-8-app">Windows 8 App</a>
      
      <div class="addthis_toolbox addthis_default_style" style="float:right;">
        <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
        <a class="addthis_button_tweet"></a>
        <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
        <a class="addthis_button_linkedin_counter"></a>
        <a class="addthis_counter addthis_pill_style"></a>
      </div>
    </div>
        
    &lt;p&gt;In my last post about &lt;a href=&quot;http://www.philliphaydon.com/2013/01/windows-store-app-with-caliburn-micro-basic-binding&quot;&gt;Basic Binding&lt;/a&gt; we added the ability to Hide/Show a control using Viability property of the control to make it &lt;code&gt;Visible&lt;/code&gt; or &lt;code&gt;Collapsed&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;However the View Model shouldn't have any real knowledge of how the view works, meaning it shouldn't actually dictate the visibility using the controls properties.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;note&quot;&gt;&lt;strong&gt;Note:&lt;/strong&gt; I left this out of the original post because I wanted to keep it 'Basic' without confusing binding with converters and such, making the topic more complicated&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;If in the future you changed from say &lt;code&gt;TextBlock&lt;/code&gt; to a 3rd party control called &lt;code&gt;BananaTextBlock&lt;/code&gt; and that 3rd party decided that they were not going to use the built in Viability enum, and instead decided to create their own naming convention, and enum etc. You would be forced to change your ViewModel, which isn't good.&lt;/p&gt;

&lt;p&gt;That's where Value Converters come in handy. &lt;/p&gt;

&lt;!--excerpt--&gt;

&lt;h2&gt;Creating your own Converter&lt;/h2&gt;

&lt;p&gt;Value Converters are easy to implement, simply create a new class and inherit the &lt;code&gt;IValueConverter&lt;/code&gt; interface. There are two methods you need to implement, the &lt;code&gt;Convert&lt;/code&gt;, this is where you convert your object to the target type. &lt;/p&gt;

&lt;p&gt;i.e if your View Model uses a &lt;code&gt;Boolean&lt;/code&gt;, you would accept the &lt;code&gt;Boolean&lt;/code&gt; type and convert it to a &lt;code&gt;Visibility&lt;/code&gt; type. &lt;/p&gt;

&lt;p&gt;The second method is ConvertBack, where it takes the control type and converts it back to the ViewModel type. &lt;/p&gt;

&lt;pre&gt;&lt;code&gt;public sealed class BooleanToVisibilityConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, string language)
    {
        if (!(value is bool))
            throw new ArgumentException(&quot;value is not type of boolean&quot;);        

        return (bool)value ? Visibility.Visible : Visibility.Collapsed;
    }

    public object ConvertBack(object value, Type targetType, object parameter, string language)
    {
        if (!(value is Visibility))
            throw new ArgumentException(&quot;value is not type of Visibility&quot;);

        return (Visibility)value == Visibility.Visible;
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2&gt;Registering your Value Converter&lt;/h2&gt;

&lt;p&gt;You can do this in a couple of different places, it's similar to registering any other Resource.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Page.Resources&lt;/li&gt;
&lt;li&gt;Application.Resources&lt;/li&gt;
&lt;li&gt;separate Resource file. &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I'm only going to show it at Page.Resources&lt;/p&gt;

&lt;p&gt;In the root Page node of your view, add the namespace to your converts&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;xmlns:sp=&quot;using:SampleProject.Converters&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In your View, add a element called &lt;code&gt;Page.Resources&lt;/code&gt; and then using the alias for the namespace just added &lt;code&gt;sp&lt;/code&gt; reference the converter we just created.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;Page.Resources&amp;gt;
    &amp;lt;sp:BooleanToVisibilityConverter x:Key=&quot;TrueConveter&quot; /&amp;gt;
&amp;lt;/Page.Resources&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;Key&lt;/code&gt; is the name we will use when referencing the converter.&lt;/p&gt;

&lt;h2&gt;Updating the ViewModel from Visibility to Boolean&lt;/h2&gt;

&lt;p&gt;The original post used the Visibility enum, but we need to update this to be a boolean&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;public bool TextBlockVisibility
{
    get { return _textBlockVisibility; }
    set
    {
        if (value == _textBlockVisibility)
            return;

        _textBlockVisibility = value;

        NotifyOfPropertyChange();
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The button we used to change the value is also updated&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;private void UpdateText()
{
    TextBlockVisibility = !TextBlockVisibility;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This will just invert the existing value each time it's clicked, like before.&lt;/p&gt;

&lt;h2&gt;Using the converter&lt;/h2&gt;

&lt;p&gt;Now we need to update the &lt;code&gt;TextBlock&lt;/code&gt; from the original post&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;TextBlock FontSize=&quot;28&quot; 
           Text=&quot;{Binding Message}&quot; 
           Visibility=&quot;{Binding TextBlockVisibility}&quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To use the converter, in the binding we simply want to add a comma at the end and specify a Converter&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;TextBlock FontSize=&quot;28&quot;
           Text=&quot;{Binding Message}&quot;
           Visibility=&quot;{Binding TextBlockVisibility,
                        Converter={StaticResource TrueConveter}}&quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now when we run the app, and click the button, it should hide/show, and our ViewModel now no longer needs to know how to change the visibility of the control. &lt;/p&gt;


	<div class="divider"></div>
	<div id="disqus_thread"></div>
	<script>
	    var disqus_shortname = 'philliphaydon';
	    var disqus_url = "http://www.philliphaydon.com@Model.Url";

	    /* * * DON'T EDIT BELOW THIS LINE * * */
	    (function () {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
    
	<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-51ca97356d8c1454"></script>

</div>
                </div>
                <!-- #content -->
            </div>
            <!-- #primary .site-content -->

            <div id="secondary" class="widget-area fancy-container lightred" role="complementary">
                <aside id="text-5" class="widget widget_text">
                    <h1 class="widget-title">Follow</h1>
                    <div class="textwidget logos">
                        <a href="https://twitter.com/philliphaydon" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://twitter.com']);"><img src="/stylesheets/images/twitter.png"></a>
                        <a href="http://stackoverflow.com/users/456813/phill" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://stackoverflow.com']);"><img src="/stylesheets/images/stackoverflow.png"></a>
                        <a href="http://www.linkedin.com/in/philliphaydon" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://www.linkedin.com']);"><img src="/stylesheets/images/linkedin.png"></a>
                        <a href="https://plus.google.com/u/0/111751877537461442095" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://plus.google.com']);"><img src="/stylesheets/images/googleplus.png"></a>
                        <a href="https://coderbits.com/philliphaydon" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','https://coderbits.com/philliphaydon']);"><img src="/stylesheets/images/codebits.png"></a>
                        <a href="https://github.com/phillip-haydon" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://github.com']);"><img src="/stylesheets/images/github.png"></a>
                        <a href="http://www.codeschool.com/users/philliphaydon" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://codeschool.com']);"><img src="/stylesheets/images/codeschool.png"></a>
                        <a href="http://www.kickstarter.com/profile/phillip-haydon" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://kickstarter.com']);"><img src="/stylesheets/images/kickstarter.png"></a>
                    </div>
                    <a href="http://stackoverflow.com/users/456813/phill">
                      <img src="http://stackoverflow.com/users/flair/456813.png" width="208" height="58" alt="profile for Phill at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for Phill at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
                    </a>
                    
                    <a href="http://nancyfx.org/mvm.html"><img src="/stylesheets/images/mvm.png"></a>
                    
                    <div id = "clustrback" style="width:162px; height:133px;  background:#f7f7f7 url(http://clustrmaps.com/admin/3d/images/st4_grey.png)  center no-repeat; text-align:center;">
                      <a href="http://www2.clustrmaps.com/counter/maps.php?url=http://www.philliphaydon.com/" style="width:160px; display:block; margin:0 auto;" id="clustrMapsLink">
                        <img src="http://www2.clustrmaps.com/counter/index2.php?url=http://www.philliphaydon.com/" style="border:0px; margin:15px auto;margin:15px auto;" alt="Locations of visitors to this page" title="Locations of visitors to this page" id="clustrMapsImg" />
                      </a>
                    </div>
                </aside>
                <!--aside id="text-8" class="widget widget_text">
                    <h1 class="widget-title">Other sites</h1>
                    <div class="textwidget">
                        <a href="http://csharptube.com/" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://csharptube.com']);">csharptube.com</a><br />
                        <a href="http://thisisparrot.com/" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://thisisparrot.com']);">Parrot</a><br />
                        <a href="http://shitprogrammerswrite.com/" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://shitprogrammerswrite.com']);">Shit programmers write</a><br />
                    </div>
                </aside-->
                <aside id="linkcat-6" class="widget widget_links">
                    <h1 class="widget-title">Other Blogs</h1>
                    <ul class='xoxo blogroll'>
                        <li><a href="http://www.nickharris.net/" target="_top" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://nickharris.net/']);">Nick Harris</a></li>
                        <li><a href="http://www.mindscapehq.com/blog/" target="_top" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://www.mindscapehq.com/blog/']);">Mindscape</a></li>
                        <li><a href="http://blog.orangelightning.co.uk/" target="" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://blog.orangelightning.co.uk/']);">Phil Jones</a></li>
                        <li><a href="http://buildstarted.com/" target="" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://buildstarted.com']);">Ben Dornis</a></li>
                        <li><a href="http://jflood.net/" target="" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://jflood.net/']);">Jospeh Flood</a></li>
                    </ul>
                    
                </aside>
                <aside id="archives-4" class="widget widget_archive">
                    <h1 class="widget-title">Archive</h1>
                    <ul class="posts">
                          <li><a href="/archive#2013August">August, 2013</a></li>
                          <li><a href="/archive#2013July">July, 2013</a></li>
                          <li><a href="/archive#2013June">June, 2013</a></li>
                          <li><a href="/archive#2013May">May, 2013</a></li>
                          <li><a href="/archive#2013April">April, 2013</a></li>
                          <li><a href="/archive#2013March">March, 2013</a></li>
                          <li><a href="/archive#2013February">February, 2013</a></li>
                          <li><a href="/archive#2013January">January, 2013</a></li>
                          <li><a href="/archive#2012December">December, 2012</a></li>
                          <li><a href="/archive#2012November">November, 2012</a></li>
                          <li><a href="/archive#2012October">October, 2012</a></li>
                          <li><a href="/archive#2012September">September, 2012</a></li>
                          <li><a href="/archive#2012July">July, 2012</a></li>
                          <li><a href="/archive#2012June">June, 2012</a></li>
                          <li><a href="/archive#2012April">April, 2012</a></li>
                          <li><a href="/archive#2012March">March, 2012</a></li>
                          <li><a href="/archive#2012February">February, 2012</a></li>
                          <li><a href="/archive#2012January">January, 2012</a></li>
                          <li><a href="/archive#2011December">December, 2011</a></li>
                          <li><a href="/archive#2011November">November, 2011</a></li>
                          <li><a href="/archive#2011October">October, 2011</a></li>
                          <li><a href="/archive#2011September">September, 2011</a></li>
                          <li><a href="/archive#2011August">August, 2011</a></li>
                          <li><a href="/archive#2011July">July, 2011</a></li>
                          <li><a href="/archive#2011June">June, 2011</a></li>
                          <li><a href="/archive#2011May">May, 2011</a></li>
                          <li><a href="/archive#2011April">April, 2011</a></li>
                          <li><a href="/archive#2011March">March, 2011</a></li>
                          <li><a href="/archive#2011February">February, 2011</a></li>
                          <li><a href="/archive#2011January">January, 2011</a></li>
                          <li><a href="/archive#2010December">December, 2010</a></li>
                          <li><a href="/archive#2010November">November, 2010</a></li>
                          <li><a href="/archive#2010October">October, 2010</a></li>
                          <li><a href="/archive#2010September">September, 2010</a></li>
                          <li><a href="/archive#2009July">July, 2009</a></li>
                    </ul>
                </aside>
            </div>
            <!-- #secondary .widget-area -->


        </div>
        <!-- #main -->

        <footer id="colophon" class="site-footer" role="contentinfo">
            <div class="site-info">
                Powered by <a href="https://github.com/Sandra/Sandra.Snow" rel="generator">Sandra.Snow</a>.	
            </div>
            <!-- .site-info -->
        </footer>
        <!-- #colophon .site-footer -->
    </div>
    <!-- #page .hfeed .site -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src='/javascripts/prettify.js' type='text/javascript'></script>
    <!--script src='http://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js' type='text/javascript'></script-->
    <script type='text/javascript'>
      $(function () {
        $("pre code").parent().each(function () {
          if (!$(this).hasClass("prettyprint")) {
            $(this).addClass("prettyprint");
            a = true
          }
        });

        prettyPrint();
      });

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-655975-13']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
</body>
</html>
